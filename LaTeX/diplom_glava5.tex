\sectioncentered*{5. Описание электронной обучающей программы "El-Gamal\_Tutor"}
\addcontentsline{toc}{section}{5. Описание электронной обучающей программы "El-Gamal\_Tutor"}


Посредством среды программирования Microsoft Visual Studio Community 2017 создано приложение, предназначенное для обучения основам криптографической системы Эль-Гамаля.

\section*{5.1. Общие сведения}
\addcontentsline{toc}{subsection}{5.1 Общие сведения}

Программа написана на языке программирования C\# в визуальной среде Microsoft Visual Studio 2017 Community Edition с использованием программной платформы Microsoft .NET Framework 4.5. Проект общим объемом 1.84 Мб. Программа функционирует в операционной системе Windows 7 или новее. 

При разработке использовались модули:  System.Collections.Generic, System.ComponentModel, System.Data, System.Drawing, System.Linq, System.Text, System.Threading.Tasks, System.Windows.Forms, System.Numerics.

Размер генерируемых программой ключей теоретически ничем не ограничен, практически же он ограничен в соответствии с характеристиками компьютера, на котором запускается программа.

\section*{5.2. Функциональное назначение}
\addcontentsline{toc}{subsection}{5.2. Функциональное назначение}

Приложение предназначено для обучения методам и алгоритмам, используемым при реализации асимметричной криптографической системы Эль-Гамаля, а также частичной проверки знаний учащегося. 

Дополнительные функции приложения позволяют использовать его в качестве программы для небольших полезных в криптографии вычислений. 

\section*{5.3. Используемые технические средства}
\addcontentsline{toc}{subsection}{5.3. Используемые технические средства}

Компьютер с шестиядерным процессором 3.2 GHz, 8 Gb RAM, Microsoft Windows 10 x64.

\section*{5.4. Описание логической структуры}
\addcontentsline{toc}{subsection}{5.4. Описание логической структуры}

Программа логически разделена на две части: режим обучения и вспомогательные функции. Блок-схема алгоритма работы приведена на рис. 10.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_schematic}
		\caption{Блок-схема программы "El-Gamal\_Tutor"}
	\end{center}
\end{figure}

В режиме обучения рассматриваются математические основы, на которых базируется криптосистема Эль-Гамаля, алгоритмы генерации ключей, шифрования и расшифрования, а также основы криптоанализа системы и некоторые алгоритмы дискретного логарифмирования. Дополнительный функционал включает в себя различные вычислительные возможности, так или иначе связанные с криптосистемой Эль-Гамаля. Они могут использоваться как в совокупности с обучением криптосистеме, так и отдельно от него. 

\section*{5.5. Описание алгоритма}
\addcontentsline{toc}{subsection}{5.5. Описание алгоритма}

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_mainmenu}
		\caption{Основное меню программы "El-Gamal\_Tutor"}
	\end{center}
\end{figure}

На рис. 11 представлено основное меню программы. Вход в обучающий режим осуществляется нажатием кнопки "начать обучение". 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_genkeys}
		\caption{Генерация ключей и расшифрование}
	\end{center}
\end{figure}

В режиме генерации ключей (рис. 12) мы можем сгенерировать ключи для криптосистемы Эль-Гамаля, а также расшифровать необходимую фразу из шифротекста с использованием этих ключей.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_encrypt}
		\caption{Результат шифрования}
	\end{center}
\end{figure}


Режим шифрования, представленный на рис. 13, позволяет зашифровать сообщение пользователя с помощью введённого открытого ключа.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_primetest}
		\caption{Тест простоты произвольного числа}
	\end{center}
\end{figure}

Режим теста простоты (рис. 14) позволяет проверить, является ли введённое целое неотрицательное число простым или составным.
Для определения простоты числа в программе используется вероятностный тест Миллера-Рабина, количество «свидетелей простоты» - 4000. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_primroot}
		\caption{Вычисление перевообразного корня по заданному модулю}
	\end{center}
\end{figure}

Режим вычисления первообразного корня (рис. 15) позволяет вычислить первообразный (или примитивный) корень для большого числа. 
Поскольку полный метод вычисления первообразного корня очень медленен для больших чисел, в программе предусмотрена возможность вычисления первообразного корня по «упрощённому» методу, который даёт ответ, верный только с некоторой вероятностью.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_euler}
		\caption{Вычисление функции Эйлера}
	\end{center}
\end{figure}

Режим вычисления функции Эйлера (рис. 16) позволяет вычислить количество чисел, взаимно простых с заданным.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_modpow}
		\caption{Возведение в степень по модулю}
	\end{center}
\end{figure}

Режим возведения в степень по модулю (рис. 17) представляет собой калькулятор заданных степеней произвольных чисел по заданному модулю.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_dlog}
		\caption{Дискретное логарифмирование}
	\end{center}
\end{figure}

Режим дискретного логарифмирования (рис. 18) позволяет произвести поиск решения уравнения $A^X = B \mod M$ для произвольных целых чисел А и В и простого числа М. Для поиска решения пользователю предлагается использовать три алгоритма дискретного логарифмирования: алгоритм Гельфонда-Шенкса, $\rho$-метод Полларда и алгоритм Полига-Хеллмана. 


\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_about}
		\caption{О программе}
	\end{center}
\end{figure}


В окне «О программе» (рис. 19) мы можем увидеть информацию о приложении El-Gamal\_Tutor. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Теперь перейдем к режиму обучения. Он состоит из нескольких шагов.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_intro}
		\caption{Введение}
	\end{center}
\end{figure}

На первом шаге (рис. 21) рассказывается про операцию возведения в степень по модулю и предлагается решить три примера. Условия заданий  генерируются случайным образом.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_modpow}
		\caption{Возведение в степень по модулю}
	\end{center}
\end{figure}

На втором шаге (рис. 22) рассказывается про функцию Эйлера и предлагается решить три примера. Условия заданий так же генерируются случайным образом.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_euler}
		\caption{Функция Эйлера}
	\end{center}
\end{figure}

На третьем шаге (рис. 23) объясняется операция нахождения обратного по модулю числа, и предлагается найти два таких числа для сгенерированных условий. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_modreverse}
		\caption{Обратное по модулю число}
	\end{center}
\end{figure}

На четвёртом шаге (рис. 24) пользователю рассказывается о египетском математике и криптографе Тахере Эль-Гамале, авторе рассматриваемой криптосистемы. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_tacherelgamal}
		\caption{Тахер Эль-Гамаль}
	\end{center}
\end{figure}

Пятый шаг (рис. 25) рассказывает общую информацию о схеме Эль-Гамаля и основных стандартах где она использовалась ранее или используется по сей день.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_elgamalinfo}
		\caption{Общая информация о криптосистеме}
	\end{center}
\end{figure}

На шестом шаге (рис. 26) мы видим конкретный пример генерирования ключей криптосистемы. Числа p и x можно как вводить с клавиатуры, так и случайно сгенерировать.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_genkeys}
		\caption{Генерация ключей}
	\end{center}
\end{figure}

На следующем шаге (рис. 27) объясняется алгоритм шифрования по схеме Эль-Гамаля.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_encrypt}
		\caption{Шифрование}
	\end{center}
\end{figure}

Следующий шаг (рис. 28) показывает, как с помощью открытого и секретного ключей расшифровать сообщение, введённое и зашифрованное на предыдущем шаге.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_decrypt}
		\caption{Расшифрование}
	\end{center}
\end{figure}

На следующем шаге (рис. 29) рассказывается о математической задаче дискретного логарифмирования, её связи с криптоанализом схемы Эль-Гамаля, а также предлагается вручную решить два задания. Задания на этом шаге генерируются случайным образом. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_dlogtutor}
		\caption{Дискретный логарифм}
	\end{center}
\end{figure}

На следующем шаге (рис. 30) рассказывается о существующих экспоненциальных алгоритмах нахождения дискретного логарифма. Для наглядной демонстрации вычислительной сложности дискретного логарифмирования пользователю предлагается реализовать алгоритм полного перебора для дискретного логарифмирования и убедиться в полной непригодности этого метода даже для сравнительно небольших модулей.

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_dlogbruteforce}
		\caption{Алгоритмы дискретного логарифмирования}
	\end{center}
\end{figure}

На следующих трёх шагах (рис. 31--33) рассказывается об одном из алгоритмов дискретного логарифмирования - алгоритме Гельфонда-Шенкса, также известном как алгоритм больших и малых шагов. На первом из этих шагов пользователь получает общую информацию об алгоритме Гельфонда-Шенкса. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_gsa1}
		\caption{Общая информация об алгоритме Гельфонда-Шенкса}
	\end{center}
\end{figure}

На следующем шаге (рис. 32) пользователь знакомится с математическим обоснованием алгоритма Гельфонда-Шенкса и, на ещё одном шаге (рис. 33), пользователю демонстрируются шаги алгоритма Гельфонда-Шенкса, записанные превдокодом. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_gsa2}
		\caption{Математическое обоснование алгоритма Гельфонда-Шенкса}		
		\vspace*{\floatsep}
		\includegraphics{egt_t_gsa3}
		\caption{Псевдокод алгоритма Гельфонда-Шенкса}
	\end{center}
\end{figure}

% На следующем шаге пользователю демонстрируются шаги алгоритма Гельфонда-Шенкса, записанные превдокодом. 

%\begin{figure}[H]	
%	\begin{center}
%		\includegraphics{egt_t_gsa3}
%		\caption{Псевдокод алгоритма Гельфонда-Шенкса}
%	\end{center}
%\end{figure}

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_sph1}
		\caption{Общая информация об алгоритме Полига-Хеллмана}
	\end{center}
\end{figure}

На следующих трёх шагах (рис. 34--36) рассказывается о другом алгоритме дискретного логарифмирования - алгоритме Сильвера-Полига-Хеллмана. На первом из этих шагов пользователь получает общую информацию об этом алгоритме. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_sph2}
		\caption{Частный случай алгоритма Полига-Хеллмана}
	\end{center}
\end{figure}

На втором из этих шагов обучения (рис. 35) демонстрируется псевдокод частного случая алгоритма Полига-Хеллмана, применимого только для групп с простым порядком. Этот алгоритм используется в общем алгоритме Сильвера-Полига-Хеллмана. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_sph3}
		\caption{Общий случай алгоритма Полига-Хеллмана}
	\end{center}
\end{figure}

На третьем из этих шагов (рис. 36) обучения демонстрируется псевдокод общего случая алгоритма Полига-Хеллмана, использующего рассмотренный выше частный алгоритм Сильвера-Полига-Хеллмана и китайскую теорему об остатках. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_rho}
		\caption{Общая информация о $\rho$-методе Полларда}
	\end{center}
\end{figure}

На следующем шаге обучения (рис. 37) пользователь знакомится с общей информацией об ещё одном алгоритме дискретного логарифмирования - $\rho$-методе Полларда, его преимуществами и ограничениями.

На следующих пяти шагах (рис. 38--42) пользователю предлагается пройти небольшое теоретическое по пройденным темам. Тестирование состоит из десяти вопросов с четырьмя вариантами ответов для каждого из них.  

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_test1}
		\caption{Тест, часть 1}
	\end{center}
\end{figure}

Первая часть тестирования (рис. 38) включает в себя вопросы, касающиеся определения функции Эйлера и определения обратного по модулю числа. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_test2}
		\caption{Тест, часть 2}
	\end{center}
\end{figure}

Вторая часть тестирования (рис. 39) включает в себя два вопроса. Первый вопрос касается вычисления обратного числа по модулю с помощью функции Эйлера, второй вопрос касается вида широтекста в криптосистеме Эль-Гамаля.  

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_test3}
		\caption{Тест, часть 3}
	\end{center}
\end{figure}

Следующие два вопроса (рис. 40) касаются оснований криптографической стойкости криптосистемы Эль-Гамаля и общей формулы вычисления функции Эйлера. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_test4}
		\caption{Тест, часть 4}
	\end{center}
\end{figure}

Седьмой вопрос посвящён вычислительной сложности алгоритма Гельфонда-Шенкса. Восьмой вопрос посвящён другим криптосистемам, основанным на криптографической стойкости дискретного логарифмирования (рис. 41). 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_test5}
		\caption{Тест, часть 5}
	\end{center}
\end{figure}

Наконец, пятая часть теста (рис. 42) посвящена границам применимости и вычислительной сложности алгоритмов дискретного логарифмирования. 

\begin{figure}[H]	
	\begin{center}
		\includegraphics{egt_t_results}
		\caption{Результаты проверки знаний}
	\end{center}
\end{figure}

На завершающем шаге обучения (рис. 43) показаны результаты выполненных заданий и ответов на вопросы теста, и пользователь получает оценку своих знаний.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{5.6. Вызов и загрузка}
\addcontentsline{toc}{subsection}{5.6. Вызов и загрузка}

Вызов программы осуществляется стандартными средствами системы Windows с установленной  платформой  Microsoft .NET Framework 4.5. Имя загрузочного модуля – ElgamalTutor.exe.

\section*{5.7. Входные и выходные данные}
\addcontentsline{toc}{subsection}{5.7. Входные и выходные данные}

Входные данные – ответы на поставленные вопросы,  выходные данные – результаты тестирования и примеры работы криптосистемы.                               